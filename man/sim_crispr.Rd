% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_crispr.R
\name{sim_crispr}
\alias{sim_crispr}
\title{Simulate CRISPR Pooled Screen Data}
\usage{
sim_crispr(
  method = "exp",
  samples = "independent",
  L = 10000,
  trt_eff_mu = -0.5,
  trt_eff_sd = 0.01,
  sg_eff_prop1 = 0.5,
  sg_eff_mu1 = -0.3,
  sg_eff_sd1 = 0.1,
  sg_eff_mu2 = NULL,
  sg_eff_sd2 = NULL,
  distbDNA_sd = 0.02,
  distbDNA_mu = -0.01,
  sg_trt_eff_prop1 = 0.7,
  sg_trt_eff_mu1 = -0.2,
  sg_trt_eff_sd1 = 0.1,
  sg_trt_eff_mu2 = NULL,
  sg_trt_eff_sd2 = NULL,
  prop_sg_trt = 0.4,
  distb_trt_eff_prop1 = 1,
  distb_trt_eff_mu1 = -0.001,
  distb_trt_eff_sd1 = 0.1,
  distb_trt_eff_mu2 = NULL,
  distb_trt_eff_sd2 = NULL,
  prop_distb_trt = 0.4,
  bleh_SD = 0.1,
  noise_SD = 0.005,
  days = 5,
  reps = 5,
  n_total = 1000,
  n_ntgt = 100,
  n_sfhb = 50,
  initial_mu = 1000
)
}
\arguments{
\item{method}{Growth model used to simulate cell population. Options are `"logit"`, `"exp"`, or `"both"`. Default is `"exp"`. `"logit"` uses the logistic growth formula, modeling saturation effects as cell populations approach a carrying capacity. `"exp"` uses exponential growth, assuming unlimited resources and constant growth rate. `"both"` generates output under both logistic and exponential growth models for comparison.}

\item{samples}{Experimental design for sample generation. Options are `"independent"` or `"matched"`. Default is `"independent"`. `"independent"` means the control and treatment samples are generated independently. `"matched"` means the control and treatment samples are paired, simulating repeated measurements or shared sample origin.}

\item{L}{Carrying capacity used in the logistic growth model.}

\item{trt_eff_mu}{Mean of the treatment effect.}

\item{trt_eff_sd}{Standard deviation of the treatment effect.}

\item{sg_eff_prop1}{Proportion of sgRNAs with a primary knockout effect.}

\item{sg_eff_mu1}{Mean of the primary sgRNA knockout effect.}

\item{sg_eff_sd1}{Standard deviation of the primary sgRNA knockout effect.}

\item{sg_eff_mu2}{Mean of the remaining sgRNA knockout effects (used when not assigned to sg_eff_mu1). If not provided, defaults to -1*`sg_eff_mu1`.}

\item{sg_eff_sd2}{Standard deviation of the remaining sgRNA knockout effects. If not provided, defaults to `sg_eff_sd1`.}

\item{distbDNA_sd}{Standard deviation of the DNA damage response effect.}

\item{distbDNA_mu}{Mean of the DNA damage response effect.}

\item{sg_trt_eff_prop1}{Proportion of sgRNAs with interaction effects between sgRNA and treatment from the primary group.}

\item{sg_trt_eff_mu1}{Mean of the sgRNA-treatment interaction effect for the primary group.}

\item{sg_trt_eff_sd1}{Standard deviation of the sgRNA-treatment interaction effect for the primary group.}

\item{sg_trt_eff_mu2}{Mean of the remaining sgRNA-treatment interaction effects. If not provided, defaults to -1*`sg_trt_eff_mu1`.}

\item{sg_trt_eff_sd2}{Standard deviation of the remaining sgRNA-treatment interaction effects. If not provided, defaults to `sg_trt_eff_sd1`.}

\item{prop_sg_trt}{Proportion of sgRNAs under treatment conditions.}

\item{distb_trt_eff_prop1}{Proportion of sgRNAs with DNA damage-treatment interaction effects from the primary group.}

\item{distb_trt_eff_mu1}{Mean of the DNA damage-treatment interaction effect (primary group).}

\item{distb_trt_eff_sd1}{Standard deviation of the DNA damage-treatment interaction effect (primary group).}

\item{distb_trt_eff_mu2}{Mean of the remaining DNA damage-treatment interaction effects.}

\item{distb_trt_eff_sd2}{Standard deviation of the remaining DNA damage-treatment interaction effects.}

\item{prop_distb_trt}{Proportion of sgRNAs assigned DNA damage-treatment interaction effects.}

\item{bleh_SD}{Standard deviation of random noise across different conditions or replicates.}

\item{noise_SD}{Standard deviation of additional technical noise applied to knockout samples.}

\item{days}{Number of time points (e.g., days) across which the experiment is simulated.}

\item{reps}{Number of biological replicates per condition.}

\item{n_total}{Total number of sgRNAs, including knockout, non-targeting, and safe harbor controls.}

\item{n_ntgt}{Number of non-targeting control sgRNAs.}

\item{n_sfhb}{Number of safe harbor control sgRNAs.}

\item{initial_mu}{Mean initial abundance of each sgRNA at the beginning of the experiment.}
}
\value{
A list containing simulated read count matrices and the corresponding true effects for each sgRNA.
The structure of the returned list depends on the specified `method`:
\itemize{
  \item If \code{method = "logit"}: returns \code{sim_raw}, \code{true_eff_t}, and \code{sim_full} for logistic growth.
  \item If \code{method = "exp"}: returns \code{sim_raw}, \code{true_eff_t}, and \code{sim_full} for exponential growth.
  \item If \code{method = "both"}: returns \code{sim_logit_raw}, \code{sim_exp_raw}, \code{true_eff_t}, \code{sim_logit_full}, and \code{sim_exp_full}.
}

\describe{
  \item{\code{sim_raw}, \code{sim_logit_raw}, \code{sim_exp_raw}}{Raw counts from knockout samples only.}
  \item{\code{true_eff_t}}{Matrix of true effect values for each sgRNA under different conditions (e.g., knockout, treatment, interaction).}
  \item{\code{sim_full}, \code{sim_logit_full}, \code{sim_exp_full}}{Full raw count matrix including initial sgRNA counts, control samples, and knockout samples.}
}
}
\description{
This function generates synthetic data for CRISPR pooled screening experiments under various experimental conditions.
It simulates counts by modeling sgRNA knockout effects, treatment effects, interaction effects, sequencing noise,
and disturbances such as DNA damage responses. The function supports both exponential and logistic cell growth models.
}
